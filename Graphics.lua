Font = Font or {};
Font['A']={7,2,1,2,6,4,1,5,8,4,1,5,5,7,1,5,9,7,1,5,7,8,1,1,4,11,1,1,10,11,1,1}
Font['B']={5,2,1,10,6,2,2,1,8,3,2,1,9,4,1,2,6,6,3,1,8,7,2,1,9,8,1,3,8,10,1,2,6,11,2,1}
Font['C']={7,2,2,1,5,3,1,8,6,3,1,1,8,3,2,1,9,4,1,2,9,8,1,3,6,10,1,2,8,10,1,2,7,11,1,1}
Font['D']={5,2,1,10,6,2,2,1,7,3,2,1,9,4,1,6,8,10,1,1,6,11,2,1}
Font['E']={5,2,1,10,6,2,4,1,6,6,4,1,6,11,4,1}
Font['F']={5,2,1,10,6,2,4,1,6,6,3,1,6,7,3,1}
Font['G']={6,2,3,1,5,3,1,8,6,3,1,1,8,3,2,1,9,4,1,2,7,7,3,1,9,8,1,4,6,10,1,2,7,11,2,1}
Font['H']={5,2,1,10,9,2,1,10,6,6,3,1}
Font['I']={7,2,1,10}
Font['J']={9,2,1,9,5,8,1,3,6,10,1,2,8,10,1,2,7,11,1,1}
Font['K']={5,2,1,10,9,2,1,2,8,3,1,2,7,4,1,4,6,6,1,1,8,8,1,2,9,10,1,2,10,11,1,1}
Font['L']={5,2,1,10,6,11,4,1}
Font['M']={4,2,1,10,5,2,1,10,9,2,1,10,8,3,1,6,6,4,1,5,7,9,1,3}
Font['N']={5,2,1,10,9,2,1,10,6,4,1,2,7,6,1,3,8,8,1,3}
Font['O']={6,2,3,1,5,3,1,8,6,3,1,1,8,3,2,1,9,4,1,7,4,5,1,4,6,10,1,2,8,10,1,2,7,11,1,1}
Font['P']={5,2,1,10,6,2,3,1,8,3,2,1,9,4,1,3,6,7,3,1}
Font['Q']={6,2,3,1,5,3,1,8,6,3,1,1,8,3,2,1,9,4,1,8,4,5,1,4,7,8,1,1,8,9,1,3,6,10,1,2,7,11,1,1}
Font['R']={5,2,1,10,6,2,2,1,8,3,2,1,9,4,1,3,8,6,1,4,6,7,2,1,9,10,1,2}
Font['S']={6,2,3,1,5,3,1,3,6,3,1,1,8,3,2,1,9,4,1,1,6,6,2,1,8,7,2,1,9,8,1,3,5,9,1,2,8,10,1,2,6,11,2,1}
Font['T']={5,2,5,1,7,3,1,9}
Font['U']={5,2,1,9,9,2,1,9,8,10,1,2,6,11,2,1}
Font['V']={4,2,1,2,9,2,1,4,10,2,1,1,5,3,1,4,6,6,1,5,8,6,1,4,7,9,1,3}
Font['W']={4,2,1,4,7,2,1,4,10,2,1,2,9,3,1,9,5,5,1,7,6,5,1,6,8,6,1,6}
Font['X']={5,2,1,2,9,2,1,2,8,3,1,3,6,4,1,2,7,6,1,2,6,7,1,3,8,8,1,2,5,9,1,3,9,10,1,2,4,11,1,1}
Font['Y']={4,2,2,1,9,2,1,3,10,2,1,1,5,3,1,2,6,4,1,3,8,4,1,3,7,6,1,6}
Font['Z']={5,2,5,1,9,3,1,2,8,4,1,2,7,6,1,2,6,7,1,2,5,9,1,3,4,11,1,1,6,11,4,1}
Font['a']={7,5,1,1,5,6,2,1,8,6,2,1,9,7,1,5,6,8,3,1,5,9,1,3,8,10,1,1,6,11,2,1}
Font['b']={5,2,1,10,7,5,1,1,6,6,1,1,8,6,2,1,9,7,1,4,8,10,1,2,6,11,2,1}
Font['c']={7,5,1,1,5,6,1,5,6,6,1,1,8,6,2,1,9,7,1,1,9,9,1,2,6,11,3,1}
Font['d']={9,2,1,10,7,5,1,1,5,6,1,5,6,6,1,1,8,6,1,1,8,10,1,1,6,11,2,1}
Font['e']={7,5,1,1,5,6,1,5,6,6,1,1,8,6,2,1,9,7,1,2,6,8,3,1,9,10,1,1,6,11,3,1}
Font['f']={8,2,2,1,7,3,1,9,6,4,1,8,5,6,1,1,8,6,1,1}
Font['g']={7,5,1,1,10,5,1,2,5,6,1,7,6,6,1,1,8,6,1,3,9,6,1,1,6,9,2,1,6,10,1,1,7,11,3,1,9,12,1,1,6,13,3,1}
Font['h']={5,2,1,10,6,6,4,1,9,7,1,5}
Font['i']={7,2,1,2,7,6,1,6}
Font['j']={8,2,1,2,8,6,1,7,5,13,3,1}
Font['k']={5,2,1,10,8,6,2,1,7,7,1,2,6,8,1,1,8,9,1,2,9,10,1,2}
Font['l']={7,2,1,10}
Font['m']={9,5,1,2,4,6,1,6,5,6,4,1,10,6,1,6,7,7,1,5}
Font['n']={5,6,1,6,6,6,4,1,9,7,1,5}
Font['o']={7,5,1,1,5,6,1,5,6,6,1,1,8,6,2,1,9,7,1,4,8,10,1,2,6,11,2,1}
Font['p']={7,5,1,1,5,6,1,8,6,6,1,1,8,6,2,1,9,7,1,4,8,10,1,2,6,11,2,1}
Font['q']={5,6,5,1,5,7,1,4,9,7,1,7,8,10,1,1,6,11,2,1}
Font['r']={5,6,1,6,6,6,1,6,7,6,2,1}
Font['s']={7,5,1,1,5,6,2,1,8,6,2,1,5,7,1,1,6,8,3,1,9,9,1,2,5,10,1,1,6,11,3,1}
Font['t']={6,3,1,8,5,6,1,1,7,6,2,1,7,10,1,2,8,11,2,1}
Font['u']={5,6,1,5,9,6,1,6,8,10,1,1,6,11,2,1}
Font['v']={5,6,1,2,9,6,1,2,8,7,1,3,6,8,1,3,7,10,1,2}
Font['w']={4,6,1,2,7,6,1,2,9,6,1,5,10,6,1,1,5,7,1,5,6,7,1,5,8,8,1,4}
Font['x']={5,6,2,1,8,6,2,1,6,7,1,1,8,7,1,1,7,8,1,2,6,9,1,2,8,9,1,2,5,10,1,2,9,11,1,1}
Font['y']={5,6,1,2,9,6,1,2,8,7,1,3,6,8,1,3,7,10,1,3,5,13,2,1}
Font['z']={5,6,5,1,8,7,1,1,7,8,1,1,6,9,1,1,5,10,1,2,6,11,4,1}
Font['@']={7,2,2,1,5,3,2,1,9,3,1,2,4,4,1,6,7,4,1,1,6,5,1,2,8,5,1,5,10,5,1,2,5,7,1,2,9,7,1,2,6,9,2,1,5,10,1,1,6,11,3,1}
Font['[']={7,1,1,12,8,1,2,1,8,12,2,1}
Font['\\']={5,2,1,2,6,4,1,3,7,7,1,2,8,9,1,3,9,12,1,1}
Font[']']={5,1,3,1,7,2,1,11,5,12,2,1}
Font['^']={6,1,3,1,5,2,1,1,8,2,2,1}
Font['_']={4,13,7,1}
Font['!']={7,2,1,7,7,10,1,2}
Font['"']={6,2,1,3,8,2,1,3}
Font['#']={6,2,1,5,9,2,1,4,4,5,2,1,7,5,2,1,10,5,1,1,8,6,1,6,5,7,1,5,4,8,1,1,6,8,2,1,9,8,2,1}
Font['$']={7,1,1,12,6,2,1,1,8,2,1,2,5,3,1,3,9,3,1,2,6,6,1,1,8,7,1,1,9,8,1,3,5,9,1,2,8,10,1,2,6,11,1,1}
Font['%']={5,2,1,1,9,2,1,1,4,3,1,3,6,3,1,7,8,3,1,2,7,5,1,2,5,6,1,1,8,7,1,5,9,7,1,2,10,9,1,1,5,10,1,2,9,10,1,2}
Font['&']={6,2,2,1,5,3,1,3,6,3,1,1,8,3,1,3,6,5,1,3,7,5,1,4,5,7,1,4,4,8,1,2,9,8,1,3,8,9,1,2,6,11,2,1}
Font['\'']={6,2,2,1,7,3,1,1,6,4,1,1}
Font['(']={9,1,1,2,8,3,1,1,7,4,1,6,8,10,1,1,9,11,1,2}
Font[')']={4,1,1,1,5,2,1,1,6,3,1,2,7,5,1,4,6,9,1,2,5,11,1,1,4,12,1,1}
Font['*']={7,2,1,7,4,4,2,1,9,4,2,1,6,5,1,2,8,5,1,2,5,6,1,1,9,6,1,1}
Font['+']={7,4,1,6,4,6,3,1,8,6,3,1}
Font[',']={5,11,1,2}
Font['-']={4,6,7,1}
Font['.']={5,11,1,1}
Font['/']={9,2,1,2,8,4,1,2,7,6,1,2,6,8,1,1,5,9,1,2,4,11,1,1}
Font['0']={6,2,3,1,5,3,1,8,6,3,1,1,8,3,2,1,9,4,1,7,4,6,1,2,6,10,1,2,8,10,1,2,7,11,1,1}
Font['1']={7,2,1,10,6,3,1,2,5,4,1,1}
Font['2']={6,2,3,1,5,3,2,1,8,3,2,1,4,4,2,1,9,4,1,3,8,6,1,2,7,8,1,1,6,9,1,1,5,10,1,2,6,11,4,1}
Font['3']={6,2,3,1,5,3,1,2,8,3,2,1,9,4,1,2,7,6,2,1,8,7,2,1,9,8,1,3,5,9,1,2,8,10,1,2,6,11,2,1}
Font['4']={8,2,1,10,7,4,1,2,6,5,1,2,5,7,1,1,4,8,1,2,5,9,3,1,9,9,2,1}
Font['5']={6,2,4,1,5,3,1,4,7,5,1,1,6,6,1,1,8,6,2,1,9,7,1,4,4,9,1,1,5,10,1,1,8,10,1,2,6,11,2,1}
Font['6']={8,2,1,1,7,3,1,2,6,4,1,3,5,6,1,5,7,6,3,1,9,7,1,4,10,8,1,2,6,10,1,2,7,11,2,1}
Font['7']={5,2,5,1,9,3,1,2,8,5,1,2,7,7,1,3,6,9,1,3}
Font['8']={6,2,3,1,5,3,1,3,8,3,2,1,9,4,1,2,6,6,3,1,5,7,1,4,6,7,1,1,8,7,2,1,4,8,1,2,9,8,1,3,8,10,1,2,6,11,2,1}
Font['9']={6,2,3,1,5,3,1,2,8,3,2,1,4,4,1,3,9,4,1,3,5,6,1,2,6,7,3,1,8,8,1,1,7,9,1,2,6,11,1,1}
Font[':']={7,5,1,2,7,11,1,1}
Font[';']={7,5,1,2,7,11,1,2}
Font['{']={8,1,1,12,9,1,1,1,7,7,1,1,9,12,1,1}
Font['|']={7,0,1,14}
Font['<']={9,2,1,1,8,3,1,1,7,4,1,1,6,5,1,1,5,6,1,2,6,8,1,1,7,9,1,1,8,10,1,1,9,11,1,1}
Font['=']={4,5,7,1,4,8,7,1}
Font['}']={5,1,2,1,6,2,1,11,5,12,1,1}
Font['~']={6,0,1,1,5,1,1,1,7,1,3,1,8,2,1,1}
Font['>']={5,3,2,1,7,4,1,1,8,5,1,1,9,6,1,2,8,8,1,1,7,9,1,1,6,10,1,1,4,11,2,1}
Font['?']={6,2,3,1,5,3,2,1,8,3,2,1,5,4,1,1,9,4,1,2,8,5,1,2,7,7,1,2,7,10,1,2}

Font['水']={7,1,1,12,8,1,1,11,12,3,1,2,2,4,5,1,11,4,1,2,5,5,1,3,10,5,1,2,9,6,1,2,4,7,1,3,10,8,1,1,3,9,1,2,11,9,1,1,2,10,1,2,12,10,2,1,6,12,1,1}
Font['者']={7,1,1,7,12,2,1,1,4,3,3,1,8,3,4,1,10,4,1,2,2,5,5,1,8,5,1,3,9,5,1,1,11,5,3,1,5,7,1,6,6,7,1,1,9,7,3,1,4,8,1,1,11,8,1,5,2,9,2,1,6,9,5,1,6,12,5,1}
Font['晶']={4,1,8,1,4,2,1,4,11,2,1,4,5,3,6,1,5,5,6,1,2,7,1,6,3,7,4,1,9,7,1,6,10,7,4,1,6,8,1,5,13,8,1,5,3,9,3,1,10,9,3,1,3,12,3,1,10,12,3,1}
Font['作']={8,0,1,4,4,1,1,12,5,1,1,1,3,3,1,3,7,3,1,2,9,3,1,10,10,3,4,1,2,5,1,2,6,5,1,1,10,6,4,1,10,9,4,1}

Font['输']={3,1,1,4,9,1,2,1,8,2,1,1,10,2,1,1,2,3,1,1,4,3,2,1,7,3,1,2,11,3,2,1,6,4,1,2,8,4,6,1,2,5,1,3,4,5,1,8,7,6,1,7,8,6,2,1,11,6,1,7,13,6,1,7,3,7,1,1,9,7,1,6,8,8,1,1,5,9,1,1,2,10,2,1,8,10,1,1,8,12,1,1,12,12,1,1}
Font['入']={5,1,2,1,6,2,2,1,7,3,1,4,8,4,1,2,6,6,1,3,9,6,1,2,5,8,1,2,10,8,1,2,4,9,1,2,11,9,1,2,12,10,1,2,2,11,2,1,13,11,1,1,2,12,1,1}
Font['试']={10,1,1,9,12,1,1,2,3,2,1,1,13,2,1,1,5,4,5,1,11,4,3,1,2,5,2,1,3,6,1,7,6,6,3,1,7,7,1,5,5,9,1,2,11,9,1,3,4,10,1,2,9,10,1,1,13,10,1,3,6,11,1,1,8,11,1,1,12,12,1,1}
Font['框']={4,1,1,12,7,2,1,11,8,2,6,1,2,4,2,1,5,4,1,1,8,4,6,1,3,5,1,3,11,5,1,5,5,6,1,3,9,7,2,1,12,7,1,1,2,8,1,2,8,9,3,1,12,9,2,1,8,12,6,1}
Font['字']={7,1,1,2,2,2,5,1,8,2,6,1,2,3,2,1,13,3,1,2,2,4,2,1,4,5,8,1,9,6,2,1,8,7,1,6,2,8,6,1,9,8,5,1,6,12,2,1}
Font['吧']={7,1,1,12,8,1,6,1,2,2,1,9,3,2,3,1,10,2,1,6,12,2,1,6,13,2,1,3,5,3,1,7,8,7,2,1,11,7,1,1,13,7,1,1,3,9,2,1,13,11,1,2,8,12,5,1}
Font['在']={7,1,1,3,6,2,1,3,2,3,4,1,8,3,6,1,5,5,1,2,9,5,1,8,4,6,1,7,3,7,1,2,6,7,3,1,10,7,3,1,2,8,1,2,6,12,3,1,10,12,4,1}
Font['天']={3,1,10,1,7,2,1,7,8,2,1,6,2,5,5,1,9,5,5,1,6,8,1,2,9,8,1,2,10,9,1,2,5,10,1,1,11,10,1,2,3,11,2,1,12,11,1,1,2,12,2,1,13,12,1,1}
Font['聊']={2,1,9,1,3,2,1,9,5,2,1,12,7,2,1,7,11,2,1,11,12,2,2,1,9,3,1,8,10,3,1,1,13,3,1,7,4,4,1,1,4,7,1,1,8,8,1,1,6,9,1,1,12,9,1,1,1,10,2,1,4,10,1,1,8,11,1,2,7,12,1,1}
Font['母']={4,1,9,1,4,2,1,7,11,2,1,11,7,3,1,1,8,4,1,1,2,6,2,1,5,6,6,1,12,6,2,1,7,7,1,2,3,8,1,3,8,8,1,3,4,10,4,1,9,10,2,1,12,10,2,1,9,12,2,1}


Graphics = (function()
    local Graphics = {
        id = 1,
        root = {},
        color = {255,255,255,255},
    };

    function Graphics:DrawRect(x,y,width,height)
        local box = UI.Box.Create();
        if box == nil then
            print("无法绘制矩形:已超过最大限制");
            return;
        end
        box:Set({x=x,y=y,width=width,height=height,r=self.color[1],g=self.color[2],b=self.color[3],a=self.color[4]});
        box:Show();
        self.root[#self.root + 1] = {self.id,{box}};
        self.id = self.id + 1;
        return self.id - 1;
    end

    function Graphics:DrawText(x,y,size,letterspacing,text)
        local str = {
            array = {},
            length = 0,
            charAt = function(self,index)
                if index > 0 and index <= self.length then
                    return self.array[index];
                end
                print("数组下标越界");
            end,
        };
        local currentIndex = 1;
        while currentIndex <= #text do
            local cs = 1;
            local seperate = {0, 0xc0, 0xe0, 0xf0};
            for i = #seperate, 1, -1 do
                if string.byte(text, currentIndex) >= seperate[i] then
                    cs = i;
                    break;
                end
            end
            str.array[#str.array+1] = string.sub(text,currentIndex,currentIndex+cs-1);
            currentIndex = currentIndex + cs;
            str.length = str.length + 1;
        end
        self.root[#self.root + 1] = {self.id,{}};
        for i=1,str.length do
            local char = str:charAt(i)
            if Font[char] == nil then
                char = "?";
            end
            for j = 1,#Font[char],4 do
                local _x = Font[char][j];
                local _y = Font[char][j+1];
                local width = Font[char][j+2];
                local height = Font[char][j+3];

                local box = UI.Box.Create();
                if box == nil then
                    print("无法绘制矩形:已超过最大限制");
                    return;
                end
                if i == 1 then
                    box:Set({x=x + _x*size,y=y + _y*size,width=width*size,height=height*size,r=self.color[1],g=self.color[2],b=self.color[3],a=self.color[4]});
                else
                    box:Set({x=x + (i-1) * letterspacing + _x*size,y=y + _y*size,width=width*size,height=height*size,r=self.color[1],g=self.color[2],b=self.color[3],a=self.color[4]});
                end
                (self.root[#self.root][2])[#self.root[#self.root][2] + 1] = box;
                box:Show();
            end
        end
        self.id = self.id + 1;
        return self.id - 1;
    end

    function Graphics:Remove(id)
        for i = 1,#self.root do
            if self.root[i][1] == id then
                table.remove(self.root,i);
                collectgarbage("collect");
                return;
            end
        end
    end

    function Graphics:Show(id)
        for i = 1,#self.root do
            if self.root[i][1] == id then
                for j = 1,#self.root[i][2] do
                    self.root[i][2][j]:Show();
                end
                return;
            end
        end
    end

    function Graphics:Hide(id)
        for i = 1,#self.root do
            if self.root[i][1] == id then
                for j = 1,#self.root[i][2] do
                    self.root[i][2][j]:Hide();
                end
                return;
            end
        end
    end

    function Graphics:GetTextSize(length,fontsize,letterspacing)
        if length == 0 then
            return 0,12 * fontsize;
        end
        local width = (length - 1) * letterspacing + 11 * fontsize;
        local height = 12 * fontsize;
        return width,height;
    end

    
    function Graphics:Clean()
        self.root = {};
        collectgarbage("collect");
    end

    return Graphics;
end)();

Graphics.color = {222,55,12,255}

local box1 = Graphics:DrawRect(0,0,128,30);

local text1 = Graphics:DrawText(30,100,2,24,"ASDWVQUYPVCIUcoizajowqnrfjkbrjh");
local text2 = Graphics:DrawText(30,160,2,32,"作者:iPad水晶,QQ:1419427247");

Graphics.color = {0,255,255,255}
local text3 = Graphics:DrawText(50,400,3,48,"在聊天框输入字母试试吧");
function UI.Event:OnChat(text)
    Graphics:Remove(text3);
    text3 = Graphics:DrawText(50,400,3,36,text);
end